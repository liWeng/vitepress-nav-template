import{_ as s,o as a,c as n,a as e}from"./app.4690b2e6.js";const C=JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[{"level":3,"title":"pmm-server客户端安装","slug":"pmm-server客户端安装","link":"#pmm-server客户端安装","children":[]},{"level":3,"title":"软件介绍","slug":"软件介绍","link":"#软件介绍","children":[]},{"level":3,"title":"编写人员","slug":"编写人员","link":"#编写人员","children":[]},{"level":3,"title":"安装过程:","slug":"安装过程","link":"#安装过程","children":[]}],"relativePath":"articles/deploy/服务监控-pmm-server服务端安装.md","lastUpdated":1697780285000}'),l={name:"articles/deploy/服务监控-pmm-server服务端安装.md"},p=e(`<h3 id="pmm-server客户端安装" tabindex="-1">pmm-server客户端安装 <a class="header-anchor" href="#pmm-server客户端安装" aria-hidden="true">#</a></h3><h3 id="软件介绍" tabindex="-1">软件介绍 <a class="header-anchor" href="#软件介绍" aria-hidden="true">#</a></h3><p>pmm-server</p><h3 id="编写人员" tabindex="-1">编写人员 <a class="header-anchor" href="#编写人员" aria-hidden="true">#</a></h3><h3 id="安装过程" tabindex="-1">安装过程: <a class="header-anchor" href="#安装过程" aria-hidden="true">#</a></h3><h4 id="下载镜像-可连接外网的不需要下载及导入-如需下载按照以下命令" tabindex="-1">下载镜像（可连接外网的不需要下载及导入,如需下载按照以下命令） <a class="header-anchor" href="#下载镜像-可连接外网的不需要下载及导入-如需下载按照以下命令" aria-hidden="true">#</a></h4><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;">mkdir -p /data/images</span></span>
<span class="line"><span style="color:#A6ACCD;">cd /data/images</span></span>
<span class="line"><span style="color:#A6ACCD;">curl -O http://www.mgf.show/static/download/pmm-server/pmm-server.tar.zip </span></span>
<span class="line"><span style="color:#A6ACCD;">unzip pmm-server.tar.zip </span></span>
<span class="line"><span style="color:#A6ACCD;">docker load &lt; pmm-server.tar</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h4 id="下载基础数据文件" tabindex="-1">下载基础数据文件 <a class="header-anchor" href="#下载基础数据文件" aria-hidden="true">#</a></h4><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;">mkdir -p /data/</span></span>
<span class="line"><span style="color:#A6ACCD;">cd /data/</span></span>
<span class="line"><span style="color:#A6ACCD;">curl -O http://www.mgf.show/static/download/pmm-server/pmm-data.zip</span></span>
<span class="line"><span style="color:#A6ACCD;">unzip pmm-data.zip</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="修改权限" tabindex="-1">修改权限 <a class="header-anchor" href="#修改权限" aria-hidden="true">#</a></h4><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;">chown -R 1000:1000 /data/pmm-data/data</span></span>
<span class="line"><span style="color:#A6ACCD;">chown -R 1000:1000 /data/pmm-data/consul-data</span></span>
<span class="line"><span style="color:#A6ACCD;">chown -R 996:996 /data/pmm-data/grafana</span></span>
<span class="line"><span style="color:#A6ACCD;">chown -R 999:998 /data/pmm-data/mysql</span></span>
<span class="line"><span style="color:#A6ACCD;">#chmod -R 755 /usr/docker/pmm-server/conf </span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h4 id="编写docker-compose-文件" tabindex="-1">编写docker-compose 文件 <a class="header-anchor" href="#编写docker-compose-文件" aria-hidden="true">#</a></h4><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">mkdir -p /usr/docker/pmm-server</span></span>
<span class="line"><span style="color:#A6ACCD;">rm -rf /usr/docker/pmm-server/docker-compose.yml</span></span>
<span class="line"><span style="color:#A6ACCD;">cat &gt;&gt;/usr/docker/pmm-server/docker-compose.yml &lt;&lt;EOF</span></span>
<span class="line"><span style="color:#A6ACCD;">pmm:</span></span>
<span class="line"><span style="color:#A6ACCD;">    image: &quot;docker.mgf.show/pmm-server&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">    privileged: true</span></span>
<span class="line"><span style="color:#A6ACCD;">    volumes:</span></span>
<span class="line"><span style="color:#A6ACCD;">         - /data/pmm-data/data:/opt/prometheus/data</span></span>
<span class="line"><span style="color:#A6ACCD;">         - /data/pmm-data/consul-data:/opt/consul-data</span></span>
<span class="line"><span style="color:#A6ACCD;">         - /data/pmm-data/mysql:/var/lib/mysql</span></span>
<span class="line"><span style="color:#A6ACCD;">         - /data/pmm-data/grafana:/var/lib/grafana</span></span>
<span class="line"><span style="color:#A6ACCD;">    ports:</span></span>
<span class="line"><span style="color:#A6ACCD;">        - &quot;8090:8090&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">        - &quot;8500:8500&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">        - &quot;8888:80&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">        - &quot;4406:3306&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">        - &quot;17082:17082&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">    environment:</span></span>
<span class="line"><span style="color:#A6ACCD;">        &quot;LANG&quot;: &quot;en_US.UTF-8&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">        &quot;LC_ALL&quot;: &quot;en_US.UTF-8&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">        &quot;SERVER_USER&quot;: &quot;admin&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">        &quot;SERVER_PASSWORD&quot;: &quot;admin@hhwy&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">        &quot;PUSHTYPE&quot;:&quot;local&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">    expose:</span></span>
<span class="line"><span style="color:#A6ACCD;">        - &quot;80&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">        - &quot;8500&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">        - &quot;8090&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">        - &quot;17082&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">EOF</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">chmod -R 755 /usr/docker/pmm-server/</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div><h4 id="各个端口作用" tabindex="-1">各个端口作用 <a class="header-anchor" href="#各个端口作用" aria-hidden="true">#</a></h4><ul><li>8090：服务的端口</li><li>3306：数据库端口</li><li>80：监控界面端口</li><li>17082 TCP 消息推送端口</li></ul><h4 id="启动" tabindex="-1">启动 <a class="header-anchor" href="#启动" aria-hidden="true">#</a></h4><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;">docker-compose up -d</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="如果服务端无法访问外网可采用客户端推送的方式" tabindex="-1">如果服务端无法访问外网可采用客户端推送的方式 <a class="header-anchor" href="#如果服务端无法访问外网可采用客户端推送的方式" aria-hidden="true">#</a></h4><h5 id="客户端下载" tabindex="-1">客户端下载 <a class="header-anchor" href="#客户端下载" aria-hidden="true">#</a></h5><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;">mkdir -p /usr/docker/pmm-push-client</span></span>
<span class="line"><span style="color:#A6ACCD;">cd /usr/docker/pmm-push-client</span></span>
<span class="line"><span style="color:#A6ACCD;">curl -O http://www.mgf.show/static/download/pmm-server/alarm-manager-push-client-0.0.1.jar</span></span>
<span class="line"><span style="color:#A6ACCD;">nohup java -jar alarm-manager-push-client-0.0.1.jar 10.20.10.62 17082 &gt;log.file 2&gt;&amp;1 &amp;</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h5 id="服务端配置修改-环境变量-pushtype-改为-remote" tabindex="-1">服务端配置修改(环境变量)，&quot;PUSHTYPE&quot; 改为 &quot;remote&quot; <a class="header-anchor" href="#服务端配置修改-环境变量-pushtype-改为-remote" aria-hidden="true">#</a></h5><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;">environment:</span></span>
<span class="line"><span style="color:#A6ACCD;">        &quot;LANG&quot;: &quot;en_US.UTF-8&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">        &quot;LC_ALL&quot;: &quot;en_US.UTF-8&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">        &quot;SERVER_USER&quot;: &quot;admin&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">        &quot;SERVER_PASSWORD&quot;: &quot;admin@hhwy&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">        &quot;PUSHTYPE&quot;: &quot;remote&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div>`,22),r=[p];function o(c,i,t,d,m,u){return a(),n("div",null,r)}const A=s(l,[["render",o]]);export{C as __pageData,A as default};
